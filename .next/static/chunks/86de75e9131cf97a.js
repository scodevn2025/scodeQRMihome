(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,18566,(e,t,s)=>{t.exports=e.r(76562)},27225,9165,e=>{"use strict";e.s(["useAuthStore",()=>u,"useDeviceStore",()=>h],27225);var t=e.i(71645);let s=e=>{let t,s=new Set,r=(e,r)=>{let a="function"==typeof e?e(t):e;if(!Object.is(a,t)){let e=t;t=(null!=r?r:"object"!=typeof a||null===a)?a:Object.assign({},t,a),s.forEach(s=>s(t,e))}},a=()=>t,i={setState:r,getState:a,getInitialState:()=>o,subscribe:e=>(s.add(e),()=>s.delete(e))},o=t=e(r,a,i);return i},r=e=>e,a=e=>{let a=(e=>e?s(e):s)(e),i=e=>(function(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:r,a=t.default.useSyncExternalStore(e.subscribe,t.default.useCallback(()=>s(e.getState()),[e,s]),t.default.useCallback(()=>s(e.getInitialState()),[e,s]));return t.default.useDebugValue(a),a})(a,e);return Object.assign(i,a),i},i=e=>e?a(e):a,o=e=>t=>{try{let s=e(t);if(s instanceof Promise)return s;return{then:e=>o(e)(s),catch(e){return this}}}catch(e){return{then(e){return this},catch:t=>o(t)(e)}}};function n(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}e.s(["apiClient",()=>d],9165),e.i(47167);let c=new class{async login(e,t){try{let s=await this.getCaptcha();if(!s.success)return{success:!1,error:"Failed to get captcha"};let r=await this.performLogin(e,t,s.captcha);if(!r.success)return{success:!1,error:"Login failed"};let a=await this.getServiceToken(r.token);if(!a.success)return{success:!1,error:"Failed to get service token"};return{success:!0,token:r.token,service_token:a.service_token,security_token:a.security_token,user_id:r.user_id,user_name:r.user_name,user_avatar:r.user_avatar}}catch(e){return{success:!1,error:e instanceof Error?e.message:"Unknown error"}}}async QRlogin(){try{let e={qr_id:this.generateQRId(),timestamp:Date.now(),action:"login"};return"mijia://login?qr_id=".concat(e.qr_id,"&timestamp=").concat(e.timestamp),{success:!0,token:"qr_token_".concat(e.qr_id),service_token:"service_token_".concat(e.qr_id),security_token:"security_token_".concat(e.qr_id),user_id:"qr_user",user_name:"QR User",user_avatar:null}}catch(e){return{success:!1,error:e instanceof Error?e.message:"QR login failed"}}}async getCaptcha(){try{let e=await fetch("".concat(this.baseUrl,"/pass/serviceLoginAuth2"),{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({sid:"xiaomiio",hash:"HASH_VALUE",callback:"https://sts.api.io.mi.com/sts",qs:"%3Fsid%3Dxiaomiio%26_json%3Dtrue",user:"",_json:"true"})}),t=await e.json();return{success:!0,captcha:t}}catch(e){return{success:!1,error:"Failed to get captcha"}}}async performLogin(e,t,s){try{let r=await fetch("".concat(this.baseUrl,"/pass/serviceLoginAuth2"),{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({sid:"xiaomiio",hash:"HASH_VALUE",callback:"https://sts.api.io.mi.com/sts",qs:"%3Fsid%3Dxiaomiio%26_json%3Dtrue",user:e,hash:t,_json:"true",...s})}),a=await r.json();if(0===a.code)return{success:!0,token:a.token,user_id:a.user_id,user_name:a.user_name,user_avatar:a.user_avatar};return{success:!1,error:a.desc||"Login failed"}}catch(e){return{success:!1,error:"Login request failed"}}}async getServiceToken(e){try{let t=await fetch("".concat(this.serviceUrl,"/home/device_list"),{method:"POST",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"},body:JSON.stringify({getVirtualModel:!1,getHuamiDevices:0})}),s=await t.json();if(0===s.code)return{success:!0,service_token:s.service_token,security_token:s.security_token};return{success:!1,error:"Failed to get service token"}}catch(e){return{success:!1,error:"Service token request failed"}}}generateQRId(){return Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15)}constructor(){n(this,"baseUrl","https://account.xiaomi.com"),n(this,"serviceUrl","https://api.io.mi.com/app")}},l=new class{setSession(e){this.session=e}async request(e){var t;let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!(null==(t=this.session)?void 0:t.service_token))return{success:!1,error:"Not authenticated"};try{let t=this.generateNonce(),r=this.generateSignedNonce(this.session.ssecurity||"",t),a=this.formatData("string"==typeof s.body?s.body:"{}"),i=this.generateSignature(e,r,t,a),o=new URLSearchParams;o.append("_nonce",t),o.append("data",a),o.append("signature",i);let n=await fetch("".concat(this.baseUrl).concat(e),{method:"POST",headers:{"User-Agent":"Mozilla/5.0 (Linux; Android 6.0; Nexus 5 Build/MRA58N) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/126.0.0.0 Mobile Safari/537.36 Edg/126.0.0.0","x-xiaomi-protocal-flag-cli":"PROTOCAL-HTTP2",Cookie:"PassportDeviceId=".concat(this.session.passport_device_id,";userId=").concat(this.session.user_id,";serviceToken=").concat(this.session.service_token,";"),"Content-Type":"application/x-www-form-urlencoded",...s.headers},body:o}),c=await n.json();if(0===c.code)return{success:!0,data:c.result||c};return{success:!1,error:"获取数据失败, ".concat(c.message)}}catch(e){return{success:!1,error:e instanceof Error?e.message:"Network error"}}}generateNonce(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t="";for(let s=0;s<16;s++)t+=e.charAt(Math.floor(Math.random()*e.length));return t}generateSignedNonce(e,t){let s=e+t,r=0;for(let e=0;e<s.length;e++)r=(r<<5)-r+s.charCodeAt(e),r&=r;return btoa(r.toString())}generateSignature(e,t,s,r){let a="".concat(e,"&").concat(t,"&").concat(s,"&data=").concat(r),i=0;for(let e=0;e<a.length;e++)i=(i<<5)-i+a.charCodeAt(e),i&=i;return btoa(i.toString())}formatData(e){return e.replace(/'/g,'"').replace(/True/g,"true").replace(/False/g,"false")}async get_devices_list(){let e=await this.get_homes_list();if(!e.success||!e.data)return{success:!1,error:"Failed to get homes list"};let t=[],s=new Set;for(let a of e.data){let e="",i=!0;for(;i;){var r;let o=await this.request("/home/home_device_list",{method:"POST",body:JSON.stringify({home_owner:a.id,home_id:parseInt(a.id),limit:200,start_did:e,get_split_device:!0,support_smart_home:!0,get_cariot_device:!0,get_third_device:!0,get_share_device:!0,get_room_device:!0,get_all_device:!0})});if(o.success&&(null==(r=o.data)?void 0:r.device_info)){for(let e of o.data.device_info){let r=e.did||e.id;r&&!s.has(r)&&(s.add(r),t.push(e))}e=o.data.next_did||"",i=o.data.has_more&&""!==e}else i=!1}}return{success:!0,data:t}}async get_shared_devices(){var e;let t=await this.request("/home/home_device_list",{method:"POST",body:JSON.stringify({get_share_device:!0,get_split_device:!0,get_third_device:!0,limit:500})});return t.success&&(null==(e=t.data)?void 0:e.device_info)?{success:!0,data:t.data.device_info}:{success:!0,data:[]}}async get_all_devices(){let e=await this.get_devices_list();if(!e.success)return e;let t=await this.get_shared_devices();if(!t.success)return t;let s=[...e.data||[]],r=new Set(s.map(e=>e.id));for(let e of t.data||[]){let t=e.id;t&&!r.has(t)&&(r.add(t),s.push(e))}return{success:!0,data:s}}async get_homes_list(){var e;let t=await this.request("/v2/homeroom/gethome_merged",{method:"POST",body:JSON.stringify({fg:!0,fetch_share:!0,fetch_share_dev:!0,limit:300,app_ver:7})});return t.success&&(null==(e=t.data)?void 0:e.home_list)?{success:!0,data:t.data.home_list}:{success:!1,error:"Failed to get homes list"}}async get_scenes_list(e){var t;let s=await this.request("/appgateway/miot/appsceneservice/AppSceneService/GetSceneList",{method:"POST",body:JSON.stringify({home_id:e})});return s.success&&(null==(t=s.data)?void 0:t.scene_info_list)?{success:!0,data:s.data.scene_info_list}:{success:!0,data:[]}}async run_scene(e){let t=await this.request("/appgateway/miot/appsceneservice/AppSceneService/RunScene",{method:"POST",body:JSON.stringify({scene_id:e,trigger_key:"user.click"})});return{success:t.success,data:t.success}}async get_devices_prop(e){let t=await this.request("/miotspec/prop/get",{method:"POST",body:JSON.stringify({params:[{did:e.id,siid:2,piid:1}]})});return{success:t.success,data:t.data||[]}}async set_devices_prop(e){let t=Object.entries(e.properties).map(t=>{let[,s]=t;return{did:e.id,siid:2,piid:1,value:s}}),s=await this.request("/miotspec/prop/set",{method:"POST",body:JSON.stringify({params:t})});return{success:s.success,data:s.data||[]}}async run_action(e){let t=await this.request("/miotspec/action",{method:"POST",body:JSON.stringify({params:{did:e.device_id,siid:2,aiid:1,value:e.params}})});return{success:t.success,data:t.data||{}}}async get_device_by_name(e){let t=await this.get_devices_list();return t.success&&t.data?{success:!0,data:t.data.find(t=>t.name===e)||null}:{success:!1,error:"Failed to get devices"}}async get_device_by_id(e){let t=await this.get_devices_list();return t.success&&t.data?{success:!0,data:t.data.find(t=>t.id===e)||null}:{success:!1,error:"Failed to get devices"}}async update_device(e){let t=await this.get_device_by_id(e.device_id);if(!t.success||!t.data)return{success:!1,error:"Device not found"};let s=t.data;return s.properties={...s.properties,...e.properties},await this.set_devices_prop(s)}constructor(e){n(this,"session",null),n(this,"baseUrl","https://api.io.mi.com/app"),e&&(this.session=e)}},d=new class{async request(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{console.log("🌐 API Client: Making request to:","".concat("","/api").concat(e)),console.log("📤 API Client: Request options:",{method:t.method||"GET",headers:t.headers});let s=await fetch("".concat("","/api").concat(e),{headers:{"Content-Type":"application/json",...t.headers},...t});console.log("📥 API Client: Response received:",{status:s.status,ok:s.ok,statusText:s.statusText});let r=await s.json();return console.log("📊 API Client: Response data:",{success:r.success,hasData:!!r.data,error:r.error}),r}catch(e){return console.error("❌ API Client: Request error:",e),console.error("🔍 Error details:",{message:e instanceof Error?e.message:"Unknown error",stack:e instanceof Error?e.stack:void 0}),{success:!1,error:"Network error occurred"}}}async generateQR(){console.log("🌐 API Client: Generating QR code...");try{let e=await this.request("/auth/qr",{method:"POST"});return console.log("✅ API Client: QR generation result:",{success:e.success,hasData:!!e.data,error:e.error}),e}catch(e){return console.error("❌ API Client: QR generation error:",e),{success:!1,error:"Failed to generate QR code"}}}async checkQRStatus(e){console.log("🔍 API Client: Checking QR status for ID:",e);try{var t,s,r;let a=await this.request("/auth/qr?qr_id=".concat(e));return console.log("📥 API Client: QR status result:",{success:a.success,status:null==(t=a.data)?void 0:t.status,hasToken:!!(null==(s=a.data)?void 0:s.token),hasUser:!!(null==(r=a.data)?void 0:r.user),error:a.error}),a}catch(e){return console.error("❌ API Client: QR status check error:",e),{success:!1,error:"Failed to check QR status"}}}async getDevices(){try{let e=await l.get_all_devices();if(!e.success||!e.data)return{success:!0,data:[{id:"mock-device-1",name:"Mock Light",type:"light",model:"yeelink.light.lamp4",online:!0,properties:{on:!0,brightness:80,colorTemperature:4e3},room:"Living Room"},{id:"mock-device-2",name:"Mock Sensor",type:"sensor",model:"miaomiaoce.sensor_ht.t1",online:!0,properties:{temperature:25.5,humidity:60},room:"Bedroom"}]};{let t=e.data.map(e=>({id:e.did||e.id,name:e.name||"Unknown Device",type:this.mapDeviceType(e.model),model:e.model||"unknown",online:e.is_online||!1,properties:e.properties||{},room:e.room_name||"Unknown Room"}));return{success:!0,data:t}}}catch(e){return{success:!1,error:"Failed to get devices"}}}mapDeviceType(e){if(!e)return"unknown";let t=e.toLowerCase();return t.includes("light")||t.includes("lamp")?"light":t.includes("sensor")||t.includes("ht")?"sensor":t.includes("camera")?"camera":t.includes("speaker")?"speaker":t.includes("switch")?"switch":t.includes("plug")?"plug":"unknown"}async getHomes(){console.log("🔍 API Client: Getting homes from Mijia API...");try{let e=await l.get_homes_list();if(console.log("📥 Mijia API homes response:",e),e.success&&e.data)return{success:!0,data:e.data};return console.log("⚠️ Mijia API failed, using mock data"),{success:!0,data:[{id:"mock-home-1",name:"My Home",address:"123 Main St",roomlist:[{id:"room-1",name:"Living Room",dids:["mock-device-1"]},{id:"room-2",name:"Bedroom",dids:["mock-device-2"]}]}]}}catch(e){return console.error("❌ API Client: Get homes error:",e),{success:!1,error:"Failed to get homes"}}}async getScenes(e){console.log("🔍 API Client: Getting scenes for home:",e);try{let t=await l.get_scenes_list(e);if(console.log("📥 Mijia API scenes response:",t),t.success&&t.data)return{success:!0,data:t.data};{console.log("⚠️ Mijia API failed, using mock data");let t=[{id:"scene-1",name:"Good Morning",description:"Turn on lights and open curtains",enabled:!0,homeId:e},{id:"scene-2",name:"Good Night",description:"Turn off all lights",enabled:!0,homeId:e}];return{success:!0,data:t}}}catch(e){return console.error("❌ API Client: Get scenes error:",e),{success:!1,error:"Failed to get scenes"}}}async runScene(e){console.log("🔍 API Client: Running scene:",e);try{let t=await l.run_scene(e);if(console.log("📥 Mijia API run scene response:",t),t.success)return{success:!0,data:{message:"Scene ".concat(e," executed successfully")}};return{success:!1,error:t.error||"Failed to run scene"}}catch(e){return console.error("❌ API Client: Run scene error:",e),{success:!1,error:"Failed to run scene"}}}async getDeviceProperties(e){console.log("🔍 API Client: Getting device properties for:",e);try{let t=await l.get_devices_prop({did:e});if(console.log("📥 Mijia API device properties response:",t),t.success&&t.data)return{success:!0,data:t.data};return console.log("⚠️ Mijia API failed, using mock data"),{success:!0,data:{on:!0,brightness:80,colorTemperature:4e3,temperature:25.5,humidity:60}}}catch(e){return console.error("❌ API Client: Get device properties error:",e),{success:!1,error:"Failed to get device properties"}}}async updateDevice(e,t){console.log("🔍 API Client: Updating device:",e,t);try{let s=await l.update_device({device_id:e,properties:t});if(console.log("📥 Mijia API update device response:",s),s.success)return{success:!0,data:{message:"Device ".concat(e," updated successfully")}};return{success:!1,error:s.error||"Failed to update device"}}catch(e){return console.error("❌ API Client: Update device error:",e),{success:!1,error:"Failed to update device"}}}async executeDeviceAction(e,t){console.log("🔍 API Client: Executing device action:",e,t);try{let s=await l.run_action({device_id:e,action:t.action||"set_property",params:t.params||[]});if(console.log("📥 Mijia API execute action response:",s),s.success)return{success:!0,data:{message:"Action ".concat(t.action," executed successfully on device ").concat(e)}};return{success:!1,error:s.error||"Failed to execute device action"}}catch(e){return console.error("❌ API Client: Execute device action error:",e),{success:!1,error:"Failed to execute device action"}}}async loginWithCredentials(e,t){console.log("🔍 API Client: Login with credentials:",e);try{let s=await c.login(e,t);if(console.log("📥 Mijia Auth login response:",s),s.success)return l.setSession(s.data),{success:!0,data:s.data};return{success:!1,error:s.error||"Login failed"}}catch(e){return console.error("❌ API Client: Login with credentials error:",e),{success:!1,error:"Login failed"}}}async loginWithQR(){console.log("🔍 API Client: Login with QR");try{let e=await c.QRlogin();if(console.log("📥 Mijia Auth QR login response:",e),e.success)return l.setSession(e.data),{success:!0,data:e.data};return{success:!1,error:e.error||"QR Login failed"}}catch(e){return console.error("❌ API Client: Login with QR error:",e),{success:!1,error:"QR Login failed"}}}},u=i()(((e,t)=>(s,r,a)=>{let i,n={storage:function(e,t){let s;try{s=e()}catch(e){return}return{getItem:e=>{var t;let r=e=>null===e?null:JSON.parse(e,void 0),a=null!=(t=s.getItem(e))?t:null;return a instanceof Promise?a.then(r):r(a)},setItem:(e,t)=>s.setItem(e,JSON.stringify(t,void 0)),removeItem:e=>s.removeItem(e)}}(()=>localStorage),partialize:e=>e,version:0,merge:(e,t)=>({...t,...e}),...t},c=!1,l=new Set,d=new Set,u=n.storage;if(!u)return e(function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];console.warn("[zustand persist middleware] Unable to update item '".concat(n.name,"', the given storage is currently unavailable.")),s(...t)},r,a);let h=()=>{let e=n.partialize({...r()});return u.setItem(n.name,{state:e,version:n.version})},m=a.setState;a.setState=(e,t)=>(m(e,t),h());let p=e(function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return s(...t),h()},r,a);a.getInitialState=()=>p;let g=()=>{var e,t;if(!u)return;c=!1,l.forEach(e=>{var t;return e(null!=(t=r())?t:p)});let a=(null==(t=n.onRehydrateStorage)?void 0:t.call(n,null!=(e=r())?e:p))||void 0;return o(u.getItem.bind(u))(n.name).then(e=>{if(e)if("number"!=typeof e.version||e.version===n.version)return[!1,e.state];else{if(n.migrate){let t=n.migrate(e.state,e.version);return t instanceof Promise?t.then(e=>[!0,e]):[!0,t]}console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}return[!1,void 0]}).then(e=>{var t;let[a,o]=e;if(s(i=n.merge(o,null!=(t=r())?t:p),!0),a)return h()}).then(()=>{null==a||a(i,void 0),i=r(),c=!0,d.forEach(e=>e(i))}).catch(e=>{null==a||a(void 0,e)})};return a.persist={setOptions:e=>{n={...n,...e},e.storage&&(u=e.storage)},clearStorage:()=>{null==u||u.removeItem(n.name)},getOptions:()=>n,rehydrate:()=>g(),hasHydrated:()=>c,onHydrate:e=>(l.add(e),()=>{l.delete(e)}),onFinishHydration:e=>(d.add(e),()=>{d.delete(e)})},n.skipHydration||g(),i||p})(e=>({user:null,token:null,isAuthenticated:!1,mijiaSession:null,login:(t,s,r)=>{e({token:t,user:{...s,mijiaSession:r},isAuthenticated:!0,mijiaSession:r}),r&&l.setSession(r)},logout:()=>{e({token:null,user:null,isAuthenticated:!1,mijiaSession:null}),l.setSession(null)}}),{name:"auth-storage"})),h=i()((e,t)=>({devices:[],loading:!1,error:null,fetchDevices:async()=>{e({loading:!0,error:null});try{let t=await d.getDevices();t.success&&t.data?e({devices:t.data,loading:!1}):e({error:t.error||"Failed to fetch devices",loading:!1})}catch(t){e({error:"Network error",loading:!1})}},updateDevice:async(s,r)=>{try{let a=await d.updateDevice(s,r);if(a.success){let a=t().devices.map(e=>e.id===s?{...e,properties:{...e.properties,...r}}:e);e({devices:a})}else e({error:a.error||"Failed to update device"})}catch(t){e({error:"Network error"})}},setError:t=>{e({error:t})}}))},94542,e=>{"use strict";e.s(["default",()=>C],94542);var t=e.i(43476),s=e.i(71645),r=e.i(18566),a=e.i(27225),i=e.i(46696),o=e.i(9165),n=e.i(15288),c=e.i(19455),l=e.i(93479),d=e.i(48425),u=s.forwardRef((e,s)=>(0,t.jsx)(d.Primitive.label,{...e,ref:s,onMouseDown:t=>{var s;t.target.closest("button, input, select, textarea")||(null==(s=e.onMouseDown)||s.call(e,t),!t.defaultPrevented&&t.detail>1&&t.preventDefault())}}));u.displayName="Label";var h=e.i(25913),m=e.i(75157);let p=(0,h.cva)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),g=s.forwardRef((e,s)=>{let{className:r,...a}=e;return(0,t.jsx)(u,{ref:s,className:(0,m.cn)(p(),r),...a})});g.displayName=u.displayName;var v=e.i(77572),f=e.i(75254);let y=(0,f.default)("qr-code",[["rect",{width:"5",height:"5",x:"3",y:"3",rx:"1",key:"1tu5fj"}],["rect",{width:"5",height:"5",x:"16",y:"3",rx:"1",key:"1v8r4q"}],["rect",{width:"5",height:"5",x:"3",y:"16",rx:"1",key:"1x03jg"}],["path",{d:"M21 16h-3a2 2 0 0 0-2 2v3",key:"177gqh"}],["path",{d:"M21 21v.01",key:"ents32"}],["path",{d:"M12 7v3a2 2 0 0 1-2 2H7",key:"8crl2c"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M12 3h.01",key:"n36tog"}],["path",{d:"M12 16v.01",key:"133mhm"}],["path",{d:"M16 12h1",key:"1slzba"}],["path",{d:"M21 12v.01",key:"1lwtk9"}],["path",{d:"M12 21v-1",key:"1880an"}]]);var w=e.i(84614);let x=(0,f.default)("lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);var b=e.i(26707),_=e.i(53475),k=e.i(98919);let j=(0,f.default)("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]),N=(0,f.default)("circle-x",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);var S=e.i(16715);let C=()=>{let e=(0,r.useRouter)(),{isAuthenticated:d,login:u}=(0,a.useAuthStore)(),[h,m]=(0,s.useState)(""),[p,f]=(0,s.useState)("idle"),[C,A]=(0,s.useState)("qr"),[P,I]=(0,s.useState)({username:"",password:""}),[R,T]=(0,s.useState)(!1);(0,s.useEffect)(()=>{d&&e.push("/dashboard")},[d,e]);let M=async()=>{f("loading");try{var e;let t=await o.apiClient.generateQR();t.success&&(null==(e=t.data)?void 0:e.qrCode)?(m(t.data.qrCode),f("idle"),q()):(f("error"),i.toast.error("Không thể tạo mã QR"))}catch(e){f("error"),i.toast.error("Lỗi khi tạo mã QR")}},q=async()=>{try{let r=await o.apiClient.checkQRStatus("");if(r.success){var t,s;(null==(t=r.data)?void 0:t.status)==="confirmed"?(f("success"),i.toast.success("Đăng nhập thành công!"),await u(r.data,""),e.push("/dashboard")):(null==(s=r.data)?void 0:s.status)==="expired"?(f("error"),i.toast.error("Mã QR đã hết hạn")):setTimeout(q,2e3)}}catch(e){f("error"),i.toast.error("Lỗi khi kiểm tra trạng thái QR")}},Q=async t=>{t.preventDefault(),T(!0);try{let t=await o.apiClient.loginWithCredentials(P.username,P.password);t.success?(i.toast.success("Đăng nhập thành công!"),await u(t.data,""),e.push("/dashboard")):i.toast.error(t.error||"Đăng nhập thất bại")}catch(e){console.error("Login error:",e),i.toast.error("Lỗi khi đăng nhập")}finally{T(!1)}};return(0,t.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-purple-900 via-pink-900 to-red-900 flex items-center justify-center p-4 relative overflow-hidden",children:[(0,t.jsxs)("div",{className:"absolute inset-0 overflow-hidden",children:[(0,t.jsx)("div",{className:"absolute -top-40 -right-40 w-96 h-96 bg-gradient-to-r from-pink-500 to-purple-500 rounded-full blur-3xl animate-pulse"}),(0,t.jsx)("div",{className:"absolute -bottom-40 -left-40 w-96 h-96 bg-gradient-to-r from-blue-500 to-cyan-500 rounded-full blur-3xl animate-pulse delay-1000"}),(0,t.jsx)("div",{className:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-80 h-80 bg-gradient-to-r from-yellow-500 to-orange-500 rounded-full blur-3xl animate-pulse delay-500"}),(0,t.jsx)("div",{className:"absolute top-1/4 left-1/4 w-2 h-2 bg-white rounded-full animate-bounce delay-300"}),(0,t.jsx)("div",{className:"absolute top-3/4 right-1/4 w-3 h-3 bg-pink-300 rounded-full animate-bounce delay-700"}),(0,t.jsx)("div",{className:"absolute top-1/2 right-1/3 w-1 h-1 bg-blue-300 rounded-full animate-bounce delay-1000"}),(0,t.jsx)("div",{className:"absolute bottom-1/4 left-1/3 w-2 h-2 bg-yellow-300 rounded-full animate-bounce delay-500"}),(0,t.jsx)("div",{className:"absolute inset-0 opacity-30",style:{backgroundImage:"url(\"data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23ffffff' fill-opacity='0.05'%3E%3Ccircle cx='30' cy='30' r='1'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E\")"}})]}),(0,t.jsxs)("div",{className:"relative w-full max-w-md",children:[(0,t.jsxs)("div",{className:"text-center mb-8 animate-fade-in",children:[(0,t.jsxs)("div",{className:"inline-flex items-center justify-center w-20 h-20 bg-gradient-to-r from-pink-500 via-purple-500 to-blue-500 rounded-3xl shadow-2xl mb-6 relative group hover:scale-110 transition-transform duration-300",children:[(0,t.jsx)("div",{className:"absolute inset-0 bg-gradient-to-r from-pink-500 via-purple-500 to-blue-500 rounded-3xl blur-lg opacity-75 group-hover:opacity-100 transition-opacity duration-300"}),(0,t.jsx)(_.Wifi,{className:"h-10 w-10 text-white relative z-10 animate-pulse"})]}),(0,t.jsx)("h1",{className:"text-4xl font-bold bg-gradient-to-r from-pink-400 via-purple-400 to-blue-400 bg-clip-text text-transparent mb-3 animate-slide-up",children:"Smart Control"}),(0,t.jsx)("p",{className:"text-pink-200 text-lg animate-slide-up delay-200",children:"✨ Quản lý thiết bị thông minh ✨"})]}),(0,t.jsxs)(n.Card,{className:"backdrop-blur-xl bg-white/20 border-white/30 shadow-2xl relative overflow-hidden group hover:bg-white/25 transition-all duration-500",children:[(0,t.jsx)("div",{className:"absolute inset-0 bg-gradient-to-r from-pink-500/20 via-purple-500/20 to-blue-500/20 rounded-lg opacity-0 group-hover:opacity-100 transition-opacity duration-500"}),(0,t.jsxs)(n.CardHeader,{className:"text-center pb-4 relative z-10",children:[(0,t.jsx)(n.CardTitle,{className:"text-3xl font-bold bg-gradient-to-r from-pink-300 via-purple-300 to-blue-300 bg-clip-text text-transparent animate-pulse",children:"🚀 Đăng nhập"}),(0,t.jsx)(n.CardDescription,{className:"text-pink-200 text-lg",children:"Chọn phương thức đăng nhập của bạn"})]}),(0,t.jsx)(n.CardContent,{children:(0,t.jsxs)(v.Tabs,{value:C,onValueChange:e=>A(e),children:[(0,t.jsxs)(v.TabsList,{className:"grid w-full grid-cols-2 bg-gradient-to-r from-pink-500/20 to-purple-500/20 border border-white/20 backdrop-blur-sm",children:[(0,t.jsxs)(v.TabsTrigger,{value:"qr",className:"text-white data-[state=active]:bg-gradient-to-r data-[state=active]:from-pink-500 data-[state=active]:to-purple-500 data-[state=active]:text-white transition-all duration-300 hover:bg-white/10",children:[(0,t.jsx)(y,{className:"h-4 w-4 mr-2"}),"📱 QR Code"]}),(0,t.jsxs)(v.TabsTrigger,{value:"credentials",className:"text-white data-[state=active]:bg-gradient-to-r data-[state=active]:from-purple-500 data-[state=active]:to-blue-500 data-[state=active]:text-white transition-all duration-300 hover:bg-white/10",children:[(0,t.jsx)(w.User,{className:"h-4 w-4 mr-2"}),"👤 Tài khoản"]})]}),(0,t.jsxs)(v.TabsContent,{value:"qr",className:"space-y-6 mt-6",children:[(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-white/10 rounded-2xl mb-4",children:(0,t.jsx)(b.Smartphone,{className:"h-8 w-8 text-white"})}),(0,t.jsx)("h3",{className:"text-lg font-semibold text-white mb-2",children:"Đăng nhập bằng QR Code"}),(0,t.jsx)("p",{className:"text-slate-300 text-sm mb-6",children:"Quét mã QR bằng ứng dụng Mi Home để đăng nhập"})]}),"idle"===p&&!h&&(0,t.jsxs)(c.Button,{onClick:M,className:"w-full bg-gradient-to-r from-pink-500 via-purple-500 to-blue-500 hover:from-pink-600 hover:via-purple-600 hover:to-blue-600 text-white font-semibold py-3 rounded-xl shadow-lg hover:shadow-xl transform hover:scale-105 transition-all duration-300 relative overflow-hidden group",children:[(0,t.jsx)("div",{className:"absolute inset-0 bg-gradient-to-r from-pink-400 via-purple-400 to-blue-400 opacity-0 group-hover:opacity-20 transition-opacity duration-300"}),(0,t.jsx)(y,{className:"h-5 w-5 mr-2 relative z-10"}),(0,t.jsx)("span",{className:"relative z-10",children:"✨ Tạo mã QR ✨"})]}),"loading"===p&&(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-white mx-auto mb-4"}),(0,t.jsx)("p",{className:"text-slate-300",children:"Đang tạo mã QR..."})]}),h&&"idle"===p&&(0,t.jsxs)("div",{className:"text-center space-y-4",children:[(0,t.jsx)("div",{className:"bg-white p-4 rounded-2xl inline-block",children:(0,t.jsx)("img",{src:h,alt:"QR Code",className:"w-48 h-48"})}),(0,t.jsx)("p",{className:"text-slate-300 text-sm",children:"Quét mã QR bằng ứng dụng Mi Home"}),(0,t.jsxs)(c.Button,{variant:"outline",onClick:M,className:"text-white border-white/30 hover:bg-white/10",children:[(0,t.jsx)(S.RefreshCw,{className:"h-4 w-4 mr-2"}),"Tạo mã mới"]})]}),"success"===p&&(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)(j,{className:"h-12 w-12 text-green-400 mx-auto mb-4"}),(0,t.jsx)("p",{className:"text-green-400 font-medium",children:"Đăng nhập thành công!"})]}),"error"===p&&(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)(N,{className:"h-12 w-12 text-red-400 mx-auto mb-4"}),(0,t.jsx)("p",{className:"text-red-400 font-medium mb-4",children:"Lỗi khi tạo mã QR"}),(0,t.jsxs)(c.Button,{onClick:M,className:"bg-gradient-to-r from-blue-500 to-purple-600 hover:from-blue-600 hover:to-purple-700 text-white",children:[(0,t.jsx)(S.RefreshCw,{className:"h-4 w-4 mr-2"}),"Thử lại"]})]})]}),(0,t.jsx)(v.TabsContent,{value:"credentials",className:"space-y-6 mt-6",children:(0,t.jsxs)("form",{onSubmit:Q,className:"space-y-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(g,{htmlFor:"username",className:"text-white",children:"Tên đăng nhập"}),(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)(w.User,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-slate-400"}),(0,t.jsx)(l.Input,{id:"username",type:"text",placeholder:"Nhập tên đăng nhập",value:P.username,onChange:e=>I({...P,username:e.target.value}),className:"pl-10 bg-white/10 border-white/30 text-white placeholder:text-slate-400 focus:bg-white/20",required:!0})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(g,{htmlFor:"password",className:"text-white",children:"Mật khẩu"}),(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)(x,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-slate-400"}),(0,t.jsx)(l.Input,{id:"password",type:"password",placeholder:"Nhập mật khẩu",value:P.password,onChange:e=>I({...P,password:e.target.value}),className:"pl-10 bg-white/10 border-white/30 text-white placeholder:text-slate-400 focus:bg-white/20",required:!0})]})]}),(0,t.jsx)(c.Button,{type:"submit",className:"w-full bg-gradient-to-r from-blue-500 to-purple-600 hover:from-blue-600 hover:to-purple-700 text-white",disabled:R,children:R?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(S.RefreshCw,{className:"h-4 w-4 mr-2 animate-spin"}),"Đang đăng nhập..."]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(k.Shield,{className:"h-4 w-4 mr-2"}),"Đăng nhập"]})})]})})]})})]}),(0,t.jsx)("div",{className:"text-center mt-8",children:(0,t.jsx)("p",{className:"text-slate-400 text-sm",children:"© 2024 Smart Control. Được phát triển bởi ScodeVN"})})]})]})}}]);